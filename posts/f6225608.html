<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.ywthings.com","root":"/","images":"/images","scheme":"Mist","version":"8.5.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="减缓SYN flood危害">
<meta property="og:type" content="article">
<meta property="og:title" content="linux系统服务器安全加固">
<meta property="og:url" content="https://www.ywthings.com/posts/f6225608.html">
<meta property="og:site_name" content="hyman">
<meta property="og:description" content="减缓SYN flood危害">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-07-14T00:09:38.000Z">
<meta property="article:modified_time" content="2021-07-14T00:39:57.380Z">
<meta property="article:author" content="hyman">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="security">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.ywthings.com/posts/f6225608.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.ywthings.com/posts/f6225608.html","path":"posts/f6225608.html","title":"linux系统服务器安全加固"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>linux系统服务器安全加固 | hyman</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?97e285060b95594e74e4d3562a50a717"></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">hyman</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">一些简单的记录</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%8F%E7%BC%93SYN-flood%E5%8D%B1%E5%AE%B3"><span class="nav-number">1.</span> <span class="nav-text">减缓SYN flood危害</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%B5%E6%8A%97%E6%89%AB%E6%8F%8F"><span class="nav-number">2.</span> <span class="nav-text">抵抗扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E9%AB%98%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7"><span class="nav-number">2.1.</span> <span class="nav-text">提高服务器的安全性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%A6%E6%88%B7%E5%AE%89%E5%85%A8"><span class="nav-number">3.</span> <span class="nav-text">账户安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%81%E5%AE%9A%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%A4%9A%E4%BD%99%E7%9A%84%E8%87%AA%E5%BB%BA%E5%B8%90%E5%8F%B7"><span class="nav-number">3.1.</span> <span class="nav-text">锁定系统中多余的自建帐号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E7%B3%BB%E7%BB%9F%E5%8F%A3%E4%BB%A4%E7%AD%96%E7%95%A5"><span class="nav-number">3.2.</span> <span class="nav-text">设置系统口令策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A6%81%E7%94%A8root%E4%B9%8B%E5%A4%96%E7%9A%84%E8%B6%85%E7%BA%A7%E7%94%A8%E6%88%B7"><span class="nav-number">3.3.</span> <span class="nav-text">禁用root之外的超级用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%90%E5%88%B6%E8%83%BD%E5%A4%9Fsu%E4%B8%BAroot%E7%9A%84%E7%94%A8%E6%88%B7"><span class="nav-number">3.4.</span> <span class="nav-text">限制能够su为root的用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5shadow%E4%B8%AD%E7%A9%BA%E5%8F%A3%E4%BB%A4%E5%B8%90%E5%8F%B7"><span class="nav-number">3.5.</span> <span class="nav-text">检查shadow中空口令帐号</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%B0%8F%E5%8C%96%E6%9C%8D%E5%8A%A1"><span class="nav-number">4.</span> <span class="nav-text">最小化服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%9C%E6%AD%A2%E6%88%96%E7%A6%81%E7%94%A8%E4%B8%8E%E6%89%BF%E8%BD%BD%E4%B8%9A%E5%8A%A1%E6%97%A0%E5%85%B3%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="nav-number">4.1.</span> <span class="nav-text">停止或禁用与承载业务无关的服务</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="nav-number">5.</span> <span class="nav-text">数据访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%90%88%E7%90%86%E7%9A%84%E5%88%9D%E5%A7%8B%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-number">5.1.</span> <span class="nav-text">设置合理的初始文件权限</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="nav-number">6.</span> <span class="nav-text">网络访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8SSH%E8%BF%9B%E8%A1%8C%E7%AE%A1%E7%90%86"><span class="nav-number">6.1.</span> <span class="nav-text">使用SSH进行管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E7%AD%96%E7%95%A5%E9%99%90%E5%88%B6%E8%83%BD%E5%A4%9F%E7%AE%A1%E7%90%86%E6%9C%AC%E6%9C%BA%E7%9A%84IP%E5%9C%B0%E5%9D%80"><span class="nav-number">6.2.</span> <span class="nav-text">设置访问控制策略限制能够管理本机的IP地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A6%81%E6%AD%A2root%E7%94%A8%E6%88%B7%E8%BF%9C%E7%A8%8B%E7%99%BB%E9%99%86"><span class="nav-number">6.3.</span> <span class="nav-text">禁止root用户远程登陆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%90%E5%AE%9A%E4%BF%A1%E4%BB%BB%E4%B8%BB%E6%9C%BA"><span class="nav-number">6.4.</span> <span class="nav-text">限定信任主机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%8F%E8%94%BD%E7%99%BB%E5%BD%95banner%E4%BF%A1%E6%81%AF"><span class="nav-number">6.5.</span> <span class="nav-text">屏蔽登录banner信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B2%E6%AD%A2%E8%AF%AF%E4%BD%BF%E7%94%A8Ctrl-Alt-Del%E9%87%8D%E5%90%AF%E7%B3%BB%E7%BB%9F"><span class="nav-number">6.6.</span> <span class="nav-text">防止误使用Ctrl+Alt+Del重启系统</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E9%89%B4%E5%88%AB"><span class="nav-number">7.</span> <span class="nav-text">用户鉴别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%B8%90%E6%88%B7%E9%94%81%E5%AE%9A%E7%99%BB%E5%BD%95%E5%A4%B1%E8%B4%A5%E9%94%81%E5%AE%9A%E6%AC%A1%E6%95%B0%E3%80%81%E9%94%81%E5%AE%9A%E6%97%B6%E9%97%B4"><span class="nav-number">7.1.</span> <span class="nav-text">设置帐户锁定登录失败锁定次数、锁定时间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%B8%90%E6%88%B7TMOUT%E5%80%BC%EF%BC%8C%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E6%B3%A8%E9%94%80%E6%97%B6%E9%97%B4"><span class="nav-number">7.2.</span> <span class="nav-text">修改帐户TMOUT值，设置自动注销时间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Grub-Lilo%E5%AF%86%E7%A0%81"><span class="nav-number">7.3.</span> <span class="nav-text">Grub&#x2F;Lilo密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%90%E5%88%B6FTP%E7%99%BB%E5%BD%95"><span class="nav-number">7.4.</span> <span class="nav-text">限制FTP登录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEBash%E4%BF%9D%E7%95%99%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4%E7%9A%84%E6%9D%A1%E6%95%B0"><span class="nav-number">7.5.</span> <span class="nav-text">设置Bash保留历史命令的条数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%A1%E8%AE%A1%E7%AD%96%E7%95%A5"><span class="nav-number">8.</span> <span class="nav-text">审计策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97%E7%AD%96%E7%95%A5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">8.1.</span> <span class="nav-text">配置系统日志策略配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E5%AE%A1%E8%AE%A1%E4%BA%A7%E7%94%9F%E7%9A%84%E6%95%B0%E6%8D%AE%E5%88%86%E9%85%8D%E5%90%88%E7%90%86%E7%9A%84%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E5%92%8C%E5%AD%98%E5%82%A8%E6%97%B6%E9%97%B4"><span class="nav-number">8.2.</span> <span class="nav-text">为审计产生的数据分配合理的存储空间和存储时间</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">hyman</p>
  <div class="site-description" itemprop="description">一些简单的记录</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">187</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">39</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">129</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



          </div>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.ywthings.com/posts/f6225608.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hyman">
      <meta itemprop="description" content="一些简单的记录">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hyman">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          linux系统服务器安全加固
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-07-14 08:09:38 / 修改时间：08:39:57" itemprop="dateCreated datePublished" datetime="2021-07-14T08:09:38+08:00">2021-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/security/" itemprop="url" rel="index"><span itemprop="name">security</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="减缓SYN-flood危害"><a href="#减缓SYN-flood危害" class="headerlink" title="减缓SYN flood危害"></a>减缓SYN flood危害</h2><span id="more"></span>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">## 减少发送syn+ack包时重试次数(默认是10)</span><br><span class="line">sysctl -w net.ipv4.tcp_synack_retries = 3</span><br><span class="line">sysctl -w net.ipv4.tcp_syn_retries = 312</span><br><span class="line"></span><br><span class="line">## SYN cookies技术</span><br><span class="line">synctl -w net.ipv4.tcp_syncookies = 11</span><br><span class="line"></span><br><span class="line">## 增加backlog队列</span><br><span class="line">synctl -w net.ipv4.tcp_max_syv_backlog = 20481</span><br></pre></td></tr></table></figure>

<h2 id="抵抗扫描"><a href="#抵抗扫描" class="headerlink" title="抵抗扫描"></a>抵抗扫描</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">## 禁掉ICMP包，让主机不能被ping</span><br><span class="line">sysctl -w net.ipv4.icmp_echo_ignore_all = 11</span><br><span class="line"></span><br><span class="line">## 通过iptables防止扫描</span><br><span class="line">iptables -A FORWARD -p tcp -syn -m limit -limit 1/s -limit-burst 5 -j ACCEPT</span><br><span class="line">iptables -A FORWARD -p tcp -tcp-flags SYN,ACK,FIN,RST RST -m limit -limit 1/s -j ACCEPT</span><br><span class="line">iptables -A FORWARD -p icmp -icmp-type echo-request -m limit -limit 1/s -j ACCEPT</span><br></pre></td></tr></table></figure>

<h3 id="提高服务器的安全性"><a href="#提高服务器的安全性" class="headerlink" title="提高服务器的安全性"></a>提高服务器的安全性</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#iptables -F</span><br><span class="line">#iptables -A INPUT -p tcp --tcp-flags ALL FIN,URG,PSH -j Drop</span><br><span class="line">#iptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST -j Drop</span><br><span class="line">#iptables -A INPUT -p tcp --tcp-flags SYN,FIN SYN,FIN -j Drop</span><br><span class="line">#iptables -A INPUT -p tcp --tcp-flags SYN,SYN --dport 80 -j Drop</span><br><span class="line"></span><br><span class="line">运行以上命令后，Linux会过滤来自NMAP的扫描信息，攻击就不能获取活动的TCP端口和操作系统的版本等信息，服务器就安全一些了。</span><br></pre></td></tr></table></figure>



<h2 id="账户安全"><a href="#账户安全" class="headerlink" title="账户安全"></a>账户安全</h2><h3 id="锁定系统中多余的自建帐号"><a href="#锁定系统中多余的自建帐号" class="headerlink" title="锁定系统中多余的自建帐号"></a>锁定系统中多余的自建帐号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">检查方法:</span><br><span class="line"></span><br><span class="line">执行命令</span><br><span class="line">#cat /etc/passwd</span><br><span class="line">#cat /etc/shadow</span><br><span class="line">查看账户、口令文件，与系统管理员确认不必要的账号。对于一些保留的系统伪帐户如：bin, sys，adm，uucp，lp, nuucp，hpdb, www, daemon等可根据需要锁定登陆。</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/passwd /etc/passwd_bak</span><br><span class="line">#cp -p /etc/shadow /etc/shadow_bak</span><br><span class="line"></span><br><span class="line">加固方法:</span><br><span class="line">使用命令passwd -l &lt;用户名&gt;锁定不必要的账号。</span><br><span class="line">使用命令passwd -u &lt;用户名&gt;解锁需要恢复的账号。</span><br></pre></td></tr></table></figure>

<h3 id="设置系统口令策略"><a href="#设置系统口令策略" class="headerlink" title="设置系统口令策略"></a>设置系统口令策略</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line"></span><br><span class="line">使用命令</span><br><span class="line">#cat /etc/login.defs|grep PASS查看密码策略设置</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">cp -p /etc/login.defs /etc/login.defs_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/login.defs修改配置文件</span><br><span class="line">PASS_MAX_DAYS 90 #新建用户的密码最长使用天数</span><br><span class="line">PASS_MIN_DAYS 0 #新建用户的密码最短使用天数</span><br><span class="line">PASS_WARN_AGE 7 #新建用户的密码到期提前提醒天数</span><br><span class="line">PASS_MIN_LEN 9 #最小密码长度9</span><br></pre></td></tr></table></figure>

<h3 id="禁用root之外的超级用户"><a href="#禁用root之外的超级用户" class="headerlink" title="禁用root之外的超级用户"></a>禁用root之外的超级用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/passwd 查看口令文件，口令文件格式如下：</span><br><span class="line">login_name：password：user_ID：group_ID：comment：home_dir：command</span><br><span class="line">login_name：用户名</span><br><span class="line">password：加密后的用户密码</span><br><span class="line">user_ID：用户ID，(1 ~ 6000) 若用户ID=0，则该用户拥有超级用户的权限。查看此处是否有多个ID=0。</span><br><span class="line">group_ID：用户组ID</span><br><span class="line">comment：用户全名或其它注释信息</span><br><span class="line">home_dir：用户根目录</span><br><span class="line">command：用户登录后的执行命令</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/passwd /etc/passwd_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">使用命令passwd -l &lt;用户名&gt;锁定不必要的超级账户。</span><br><span class="line">使用命令passwd -u &lt;用户名&gt;解锁需要恢复的超级账户。</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">需要与管理员确认此超级用户的用途。</span><br></pre></td></tr></table></figure>

<h3 id="限制能够su为root的用户"><a href="#限制能够su为root的用户" class="headerlink" title="限制能够su为root的用户"></a>限制能够su为root的用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/pam.d/su,查看是否有auth required /lib/security/pam_wheel.so这样的配置条目</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/pam.d /etc/pam.d_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/pam.d/su</span><br><span class="line">在头部添加：</span><br><span class="line">auth required /lib/security/pam_wheel.so group=wheel</span><br><span class="line">这样，只有wheel组的用户可以su到root</span><br><span class="line">#usermod -G10 test 将test用户加入到wheel组</span><br><span class="line">当系统验证出现问题时，首先应当检查/var/log/messages或者/var/log/secure中的输出信息，根据这些信息判断用户账号的有效性。如果是因为PAM验证故障，而引起root也无法登录，只能使用single user或者rescue模式进行排错。</span><br></pre></td></tr></table></figure>

<h3 id="检查shadow中空口令帐号"><a href="#检查shadow中空口令帐号" class="headerlink" title="检查shadow中空口令帐号"></a>检查shadow中空口令帐号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#awk -F: &#x27;( == &quot;&quot;) &#123; print &#125;&#x27; /etc/shadow</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">cp -p /etc/shadow /etc/shadow_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">对空口令账号进行锁定，或要求增加密码</span><br></pre></td></tr></table></figure>

<h2 id="最小化服务"><a href="#最小化服务" class="headerlink" title="最小化服务"></a>最小化服务</h2><h3 id="停止或禁用与承载业务无关的服务"><a href="#停止或禁用与承载业务无关的服务" class="headerlink" title="停止或禁用与承载业务无关的服务"></a>停止或禁用与承载业务无关的服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#who –r或runlevel 查看当前init级别</span><br><span class="line">#chkconfig --list 查看所有服务的状态</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">记录需要关闭服务的名称</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#chkconfig --level &lt;服务名&gt; on|off|reset 设置服务在个init级别下开机是否启动</span><br></pre></td></tr></table></figure>

<h2 id="数据访问控制"><a href="#数据访问控制" class="headerlink" title="数据访问控制"></a>数据访问控制</h2><h3 id="设置合理的初始文件权限"><a href="#设置合理的初始文件权限" class="headerlink" title="设置合理的初始文件权限"></a>设置合理的初始文件权限</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/profile 查看umask的值</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/profile /etc/profile_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/profile</span><br><span class="line">umask=027</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">会修改新建文件的默认权限，如果该服务器是WEB应用，则此项谨慎修改。</span><br></pre></td></tr></table></figure>

<h2 id="网络访问控制"><a href="#网络访问控制" class="headerlink" title="网络访问控制"></a>网络访问控制</h2><h3 id="使用SSH进行管理"><a href="#使用SSH进行管理" class="headerlink" title="使用SSH进行管理"></a>使用SSH进行管理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#ps –aef | grep sshd 查看有无此服务</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">使用命令开启ssh服务</span><br><span class="line">#service sshd start</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">改变管理员的使用习惯</span><br></pre></td></tr></table></figure>

<h3 id="设置访问控制策略限制能够管理本机的IP地址"><a href="#设置访问控制策略限制能够管理本机的IP地址" class="headerlink" title="设置访问控制策略限制能够管理本机的IP地址"></a>设置访问控制策略限制能够管理本机的IP地址</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/ssh/sshd_config 查看有无AllowUsers的语句</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/ssh/sshd_config /etc/ssh/sshd_config_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/ssh/sshd_config，添加以下语句</span><br><span class="line">AllowUsers *@10.138.*.* 此句意为：仅允许10.138.0.0/16网段所有用户通过ssh访问</span><br><span class="line">保存后重启ssh服务</span><br><span class="line">#service sshd restart</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">需要和管理员确认能够管理的IP段</span><br></pre></td></tr></table></figure>

<h3 id="禁止root用户远程登陆"><a href="#禁止root用户远程登陆" class="headerlink" title="禁止root用户远程登陆"></a>禁止root用户远程登陆</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/ssh/sshd_config 查看PermitRootLogin是否为no</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/ssh/sshd_config /etc/ssh/sshd_config_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/ssh/sshd_config</span><br><span class="line">PermitRootLogin no</span><br><span class="line">保存后重启ssh服务</span><br><span class="line">service sshd restart</span><br></pre></td></tr></table></figure>

<h3 id="限定信任主机"><a href="#限定信任主机" class="headerlink" title="限定信任主机"></a>限定信任主机</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/hosts.equiv 查看其中的主机</span><br><span class="line">#cat /$HOME/.rhosts 查看其中的主机</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/hosts.equiv /etc/hosts.equiv_bak</span><br><span class="line">#cp -p /$HOME/.rhosts /$HOME/.rhosts_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/hosts.equiv 删除其中不必要的主机</span><br><span class="line">#vi /$HOME/.rhosts 删除其中不必要的主机</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">在多机互备的环境中，需要保留其他主机的IP可信任。</span><br></pre></td></tr></table></figure>

<h3 id="屏蔽登录banner信息"><a href="#屏蔽登录banner信息" class="headerlink" title="屏蔽登录banner信息"></a>屏蔽登录banner信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/ssh/sshd_config 查看文件中是否存在Banner字段，或banner字段为NONE</span><br><span class="line">#cat /etc/motd 查看文件内容，该处内容将作为banner信息显示给登录用户。</span><br><span class="line"></span><br><span class="line">份方法：</span><br><span class="line">#cp -p /etc/ssh/sshd_config /etc/ssh/sshd_config_bak</span><br><span class="line">#cp -p /etc/motd /etc/motd_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/ssh/sshd_config</span><br><span class="line">banner NONE</span><br><span class="line">#vi /etc/motd</span><br><span class="line">删除全部内容或更新成自己想要添加的内容</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">无可见风险</span><br></pre></td></tr></table></figure>

<h3 id="防止误使用Ctrl-Alt-Del重启系统"><a href="#防止误使用Ctrl-Alt-Del重启系统" class="headerlink" title="防止误使用Ctrl+Alt+Del重启系统"></a>防止误使用Ctrl+Alt+Del重启系统</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/inittab|grep ctrlaltdel 查看输入行是否被注释</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/inittab /etc/inittab_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/inittab</span><br><span class="line">在行开头添加注释符号“#”</span><br><span class="line">#ca::ctrlaltdel:/sbin/shutdown -t3 -r now</span><br></pre></td></tr></table></figure>

<h2 id="用户鉴别"><a href="#用户鉴别" class="headerlink" title="用户鉴别"></a>用户鉴别</h2><h3 id="设置帐户锁定登录失败锁定次数、锁定时间"><a href="#设置帐户锁定登录失败锁定次数、锁定时间" class="headerlink" title="设置帐户锁定登录失败锁定次数、锁定时间"></a>设置帐户锁定登录失败锁定次数、锁定时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/pam.d/system-auth 查看有无auth required pam_tally.so条目的设置</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/pam.d/system-auth /etc/pam.d/system-auth_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/pam.d/system-auth</span><br><span class="line">auth required pam_tally.so onerr=fail deny=6 unlock_time=300 设置为密码连续错误6次锁定，锁定时间300秒</span><br><span class="line">解锁用户 faillog -u &lt;用户名&gt; -r</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">需要PAM包的支持;对pam文件的修改应仔细检查，一旦出现错误会导致无法登陆;</span><br><span class="line">当系统验证出现问题时，首先应当检查/var/log/messages或者/var/log/secure中的输出信息，根据这些信息判断用户账号的有效性。</span><br></pre></td></tr></table></figure>

<h3 id="修改帐户TMOUT值，设置自动注销时间"><a href="#修改帐户TMOUT值，设置自动注销时间" class="headerlink" title="修改帐户TMOUT值，设置自动注销时间"></a>修改帐户TMOUT值，设置自动注销时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/profile 查看有无TMOUT的设置</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/profile /etc/profile_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/profile</span><br><span class="line">增加</span><br><span class="line">TMOUT=600 无操作600秒后自动退出</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">无可见风险</span><br></pre></td></tr></table></figure>

<h3 id="Grub-Lilo密码"><a href="#Grub-Lilo密码" class="headerlink" title="Grub/Lilo密码"></a>Grub/Lilo密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/grub.conf|grep password 查看grub是否设置密码</span><br><span class="line">#cat /etc/lilo.conf|grep password 查看lilo是否设置密码</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/grub.conf /etc/grub.conf_bak</span><br><span class="line">#cp -p /etc/lilo.conf /etc/lilo.conf_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">为grub或lilo设置密码</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">etc/grub.conf通常会链接到/boot/grub/grub.conf</span><br></pre></td></tr></table></figure>

<h3 id="限制FTP登录"><a href="#限制FTP登录" class="headerlink" title="限制FTP登录"></a>限制FTP登录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/ftpusers 确认是否包含用户名，这些用户名不允许登录FTP服务</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/ftpusers /etc/ftpusers_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/ftpusers 添加行，每行包含一个用户名，添加的用户将被禁止登录FTP服务</span><br><span class="line"></span><br><span class="line">风险：</span><br><span class="line">无可见风险</span><br></pre></td></tr></table></figure>

<h3 id="设置Bash保留历史命令的条数"><a href="#设置Bash保留历史命令的条数" class="headerlink" title="设置Bash保留历史命令的条数"></a>设置Bash保留历史命令的条数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/profile|grep HISTSIZE=</span><br><span class="line">#cat /etc/profile|grep HISTFILESIZE= 查看保留历史命令的条数</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/profile /etc/profile_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/profile</span><br><span class="line">修改HISTSIZE=5和HISTFILESIZE=5即保留最新执行的5条命令</span><br></pre></td></tr></table></figure>

<h2 id="审计策略"><a href="#审计策略" class="headerlink" title="审计策略"></a>审计策略</h2><h3 id="配置系统日志策略配置文件"><a href="#配置系统日志策略配置文件" class="headerlink" title="配置系统日志策略配置文件"></a>配置系统日志策略配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#ps -aef | grep syslog 确认syslog是否启用</span><br><span class="line">#cat /etc/syslog.conf 查看syslogd的配置，并确认日志文件是否存在</span><br><span class="line">系统日志(默认)/var/log/messages</span><br><span class="line">cron日志(默认)/var/log/cron</span><br><span class="line">安全日志(默认)/var/log/secure</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/syslog.conf</span><br></pre></td></tr></table></figure>

<h3 id="为审计产生的数据分配合理的存储空间和存储时间"><a href="#为审计产生的数据分配合理的存储空间和存储时间" class="headerlink" title="为审计产生的数据分配合理的存储空间和存储时间"></a>为审计产生的数据分配合理的存储空间和存储时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">检查方法：</span><br><span class="line">#cat /etc/logrotate.conf 查看系统轮询配置，有无</span><br><span class="line"># rotate log files weekly</span><br><span class="line">weekly</span><br><span class="line"># keep 4 weeks worth of backlogs</span><br><span class="line">rotate 4 的配置</span><br><span class="line"></span><br><span class="line">备份方法：</span><br><span class="line">#cp -p /etc/logrotate.conf /etc/logrotate.conf_bak</span><br><span class="line"></span><br><span class="line">加固方法：</span><br><span class="line">#vi /etc/logrotate.d/syslog</span><br><span class="line">增加</span><br><span class="line">rotate 4 日志文件保存个数为4，当第5个产生后，删除最早的日志</span><br><span class="line">size 100k 每个日志的大小</span><br><span class="line">加固后应类似如下内容：</span><br><span class="line">/var/log/syslog/*_log &#123;</span><br><span class="line">missingok</span><br><span class="line">notifempty</span><br><span class="line">size 100k # log files will be rotated when they grow bigger that 100k.</span><br><span class="line">rotate 5 # will keep the logs for 5 weeks.</span><br><span class="line">compress # log files will be compressed.</span><br><span class="line">sharedscripts</span><br><span class="line">postrotate</span><br><span class="line">/etc/init.d/syslog condrestart &gt;/dev/null 2&gt;1 || true</span><br><span class="line">endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"># linux</a>
              <a href="/tags/security/" rel="tag"># security</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/93ef4b74.html" rel="prev" title="系统日志出现 container not found">
                  <i class="fa fa-chevron-left"></i> 系统日志出现 container not found
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/8f89a6cb.html" rel="next" title="CentOS7 命令行安装Oracle 11G R2">
                  CentOS7 命令行安装Oracle 11G R2 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hyman</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/third-party/search/local-search.js"></script>




  





</body>
</html>
